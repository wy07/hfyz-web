<div *ngIf="isDetails==false && edit==false">
    <div class="querys">
        <div class="row form-horizontal">
            <div class="col-sm-5">
                <div class="form-group">
                    <label class="col-sm-4 control-label">业户名称：</label>
                    <div class="col-sm-8">
                        <input type="text" class="form-control" [(ngModel)]="company" name="company" placeholder="请输入业户名称..." />
                    </div>
                </div>
            </div>
            <div class="col-sm-5">
                <div class="form-group">
                    <label class="col-sm-4 control-label">状态：</label>
                    <div class="col-sm-8">
                        <p-dropdown [options]="statusList" [(ngModel)]="listStatus" placeholder="请选择状态" styleClass=p-dropdown-form-control></p-dropdown>
                    </div>
                </div>
            </div>
            <div class="col-sm-5">
                <div class="form-group">
                    <label class="col-sm-4 control-label">有效期至：</label>
                    <div class="col-sm-8 calendar-group">
                        <div class="cgl">
                            <p-calendar [(ngModel)]="startDate" name="startDate" [maxDate]="maxDate" [readonlyInput]="true" [showTime]="true" [showIcon]="true"
                                dateFormat="yy-mm-dd" styleClass=calendar-span inputStyleClass=calendar></p-calendar>
                        </div>
                        <div class="cgm">-</div>
                        <div class="cgr">
                            <p-calendar [(ngModel)]="endDate" name="endDate" [maxDate]="maxDate" [readonlyInput]="true" [showTime]="true" [showIcon]="true"
                                dateFormat="yy-mm-dd" styleClass=calendar-span inputStyleClass=calendar></p-calendar>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-5 col-sm-offset-1">
                <button type="button" pButton label="检索" (click)="initData()"></button>
                <button type="button" pButton label="重置" (click)="cancel()"></button>
            </div>
        </div>
    </div>
    <div class="top-buttons">
        <button pButton type="button" label="新增" (click)="onCreat()"></button>
    </div>
    <p-dataTable [value]="hiddenRectificationOrderList" [emptyMessage]="'暂无数据'">
        <p-column field="billNo" header="单据编号"></p-column>
        <p-column field="enterpirse" header="业户名称"></p-column>
        <p-column field="examiner" header="检查人"></p-column>
        <p-column field="inspectionDate" header="检查日期"></p-column>
        <p-column field="dealineDate" header="整改期限"></p-column>
        <p-column field="status" header="状态"></p-column>
        <p-column field="" header="操作" styleClass=operation-buttons-4>
            <ng-template let-hiddenRectificationOrder="rowData" pTemplate="body">
                <div role="button" class="fa fa-list fa-font-size div-distance" (click)="preEdit(hiddenRectificationOrder.id)" tooltip="详情"
                    placement="bottom"></div>
                <div role="button" class="fa fa-pencil-square-o fa-font-size div-distance" (click)="onEdit(hiddenRectificationOrder)" tooltip="编辑"
                    placement="bottom" *ngIf="hiddenRectificationOrder.status=='起草' || hiddenRectificationOrder.status=='已拒绝'"></div>
                <div role="button" class="fa fa-times fa-font-size div-distance" (click)="onDelete(hiddenRectificationOrder)" tooltip="删除"
                    placement="bottom" *ngIf="hiddenRectificationOrder.status=='起草'"></div>
                <div role="button" class="fa fa-check-square-o fa-font-size div-distance" (click)="commit(hiddenRectificationOrder)" tooltip="提交"
                    placement="bottom" *ngIf="hiddenRectificationOrder.status=='起草' || hiddenRectificationOrder.status=='已拒绝'"></div>
            </ng-template>
        </p-column>
    </p-dataTable>
    <p-paginator rows="{{max}}" totalRecords="{{total}}" (onPageChange)="paginate($event)"></p-paginator>
</div>

<div *ngIf="edit">
    <div class="panel panel-default">
        <div class="panel-heading">
            {{hiddenRectificationOrderTitle}}
        </div>
        <div class="panel-body">
            <form class="form-horizontal">
                <div class="form-group">
                    <div class="col-sm-6">
                        <label for="enterpirse" class="col-sm-4 " right>业户名称：<span class="notNull">*</span></label>
                        <div class="col-sm-6">
                            <p-autoComplete id="enterpirse" name="enterpirse" [(ngModel)]="selectedCompany" [suggestions]="filteredEnterpirses" (onSelect)="onSelect($event)"
                                field="info" (completeMethod)="filteredEnterpirse($event)" [size]="30" [minLength]="1" [delay]="500">
                                <ng-template let-enterpirse pTemplate="item">
                                    {{enterpirse.ownerName}}
                                </ng-template>
                            </p-autoComplete>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <label for="area" class="col-sm-4 " right>区域：</label>
                        <div class="col-sm-6">
                            <input type="text" class="form-control" id="area" name="area" [(ngModel)]="hiddenRectificationOrder.area">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-sm-6">
                        <label for="inspectionDate" class="col-sm-4" right>检查日期：<span
                            class="notNull">*</span></label>
                        <div class="col-sm-6">
                            <p-calendar name="inspectionDate" id="inspectionDate" dateFormat="yy-mm-dd" [showTime]="true" [readonlyInput]="true" [(ngModel)]="inspection" [showIcon]="true"></p-calendar>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <label for="examiner" class="col-sm-4 " right>检查人：<span
                            class="notNull">*</span></label>
                        <div class="col-sm-6">
                            <input type="text" class="form-control" id="examiner" name="examiner" [(ngModel)]="hiddenRectificationOrder.examiner">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-sm-6">
                        <label for="dealineDate" class="col-sm-4 " right>整改期限：<span class="notNull">*</span></label>
                        <div class="col-sm-6">
                            <p-calendar name="dealineDate" id="dealineDate" dateFormat="yy-mm-dd" [showTime]="true" [readonlyInput]="true" [(ngModel)]="dealine" [showIcon]="true">
                            </p-calendar>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-sm-12">
                        <label for="insPosition" class="col-sm-2 " right>检查地点：<span
                            class="notNull">*</span></label>
                        <div class="col-sm-6">
                            <textarea class="form-control fix" id="insPosition" name="insPosition" [(ngModel)]="hiddenRectificationOrder.insPosition"
                                maxlength="1500"></textarea>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-sm-12">
                        <label for="insDesc" class="col-sm-2 " right>检查内容：<span
                            class="notNull">*</span></label>
                        <div class="col-sm-6">
                            <textarea class="form-control fix" id="insDesc" name="insDesc" [(ngModel)]="hiddenRectificationOrder.insDesc" maxlength="1500"></textarea>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-sm-12">
                        <label for="insQuestion" class="col-sm-2 " right>存在问题：<span
                            class="notNull">*</span></label>
                        <div class="col-sm-6">
                            <textarea class="form-control fix" id="insQuestion" name="insQuestion" [(ngModel)]="hiddenRectificationOrder.insQuestion"
                                maxlength="1500"></textarea>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-sm-12">
                        <label for="proPosal" class="col-sm-2" right>整改意见：<span class="notNull">*</span></label>
                        <div class="col-sm-6">
                            <textarea class="form-control fix" id="proPosal" name="proPosal" [(ngModel)]="hiddenRectificationOrder.proPosal" maxlength="1500"></textarea>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-2">
                        <button pButton type="button" label="保存" (click)="onSaveNew()"></button>
                        <button pButton type="button" label="返回" (click)="return()"></button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
<p-dialog header="提示" [(visible)]="displayDialog" modal="modal" height="200" width="300" [responsive]="true">
    <P>是否保存信息？请选择！</P>
    <p-footer>
        <button type="button" pButton icon="fa-check" (click)="isAdd?onSave():update()" label="是"></button>
        <button type="button" pButton icon="fa-close" (click)="onCancel()" label="否"></button>
    </p-footer>
</p-dialog>

<div *ngIf="isDetails">
    <div class="panel panel-default">
        <div class="panel-heading">
            {{hiddenRectificationOrderTitle}}
            <button type="button" class="btn back-btn" (click)="return()">返回</button>
        </div>
        <div class="panel-body">
            <form class="form-horizontal">
                <div class="form-group">
                    <label class="col-sm-1" right>业户名称:</label>
                    <div class="col-sm-4">
                        <span>{{hiddenRectificationOrder.enterpirse}}</span>
                    </div>
                    <label class="col-sm-1" right>区域：</label>
                    <div class="col-sm-4">
                        <span>{{hiddenRectificationOrder.area || '无'}}</span>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-1" right>检查日期：</label>
                    <div class="col-sm-4">
                        <span>{{inspection | date: "yyyy-MM-dd HH:mm"}}</span>
                    </div>
                    <label class="col-sm-1" right>检查人：</label>
                    <div class="col-sm-4">
                        <span>{{hiddenRectificationOrder.examiner}}</span>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-1" right>整改期限：</label>
                    <div class="col-sm-4">
                        <span>{{dealine | date: "yyyy-MM-dd HH:mm"}}</span>
                    </div>
                    <label class="col-sm-1 " right>状态：</label>
                    <div class="col-sm-4">
                        <span>{{hiddenRectificationOrder.status}}</span>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-1" right>检查地点：</label>
                    <div class="col-sm-8">
                        <span>{{hiddenRectificationOrder.insPosition}}</span>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-1" right>检查内容：</label>
                    <div class="col-sm-8">
                        <span>{{hiddenRectificationOrder.insDesc}}</span>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-1" right>存在问题：</label>
                    <div class="col-sm-8">
                        <span>{{hiddenRectificationOrder.insQuestion}}</span>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-1" right>整改意见：</label>
                    <div class="col-sm-8">
                        <span>{{hiddenRectificationOrder.proPosal}}</span>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-1" right>企业反馈：</label>
                    <div class="col-sm-8">
                        <span>{{hiddenRectificationOrder.replyDesc || '无'}}</span>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-1" right>反馈日期：</label>
                    <div class="col-sm-8">
                        <span>{{hiddenRectificationOrder.replyDate || '无'}}</span>
                    </div>
                </div>
                <div class="panel-body">
                    <div class="row">
                        <div class="col-md-12">
                            <p-dataTable [value]="reviewAndApprovalList" [emptyMessage]="'暂无数据'">
                                <p-column field="approver" header="审核人">
                                    <ng-template let-reviewAndApproval="rowData" pTemplate="body">
                                        <span>{{reviewAndApproval.approver || '无'}}</span>
                                    </ng-template>
                                </p-column>
                                <p-column field="approveTime" header="审核日期">
                                    <ng-template let-reviewAndApproval="rowData" pTemplate="body">
                                        <span>{{reviewAndApproval.approveTime || '无'}}</span>
                                    </ng-template>
                                </p-column>
                                <p-column field="approveDesc" header="审核内容">
                                    <ng-template let-reviewAndApproval="rowData" pTemplate="body">
                                        <span>{{reviewAndApproval.approveDesc || '无'}}</span>
                                    </ng-template>
                                </p-column>
                                <p-column field="approvalResult" header="审核结果">
                                    <ng-template let-reviewAndApproval="rowData" pTemplate="body">
                                        <span>{{reviewAndApproval.approvalResult? '通过':'拒绝'}}</span>
                                    </ng-template>
                                </p-column>
                            </p-dataTable>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>